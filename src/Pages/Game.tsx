import React from "react";
// import { useParams } from "react-router-dom";
// import Decompressor from "../Utils/Decompressor";
import { buildCode } from "../Utils/gameCodeBuilder";

const frameStyle: React.CSSProperties = {
  width: "100vw",
  height: "80vh",
  border: "none",
};

export default function () {
  console.log("aaa");
  // const { compressedCode } = useParams<{ compressedCode: string }>();
  const compressedCode =
    "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";
  console.log(compressedCode);
  console.log(atob(compressedCode));
  // const code = new Decompressor(compressedCode).decompress();
  // console.log(code);
  const code = `
  <meta content=1.0 name=gv><meta content=snake name=gi><meta content=SNAKEYR name=gs><title>Snake</title><meta content="width=device-width,initial-scale=1"name=viewport><style>div{position:absolute}#game-content,body,html{width:100%;height:100%}.pg{background-color:#9acd32;top:9vh;border:8px solid #000}.dirBtn{background-color:transparent;height:100vh;width:50vw}.right{left:50vw}.snkPart{background-color:green;border:1px solid #000}.food{background-color:red;border:1px solid #000}.go{width:100vw;height:100vh;top:0;left:0;background-color:rgba(79,79,79,.3);padding-top:45vh;text-align:center;font-size:xx-large}.sBox{font-weight:700;font-size:x-large;padding-left:4vw;padding-top:2vh}</style><script>var e=function(){return function(){var e=this;this.move=function(){for(var t=e.body.length-1;t>0;t--)e.body[t]=e.body[t-1].slice();var n="LEFT"===e.direction?e.body[0][0]-1:"RIGHT"===e.direction?e.body[0][0]+1:e.body[0][0],o="UP"===e.direction?e.body[0][1]-1:"DOWN"===e.direction?e.body[0][1]+1:e.body[0][1];e.body[0]=[n,o]},this.turn=function(t){var n="LEFT"===t?1:-1,o=["UP","LEFT","DOWN","RIGHT"];e.direction=o[(o.indexOf(e.direction)+4+n)%4]},this.grow=function(){e.body=e.body.concat([e.body[e.body.length-1].slice()])},this.getBody=function(){return e.body.slice()},this.getLength=function(){return e.body.length},this.initialLength=4,this.direction="UP",this.body=[[5,5],[5,6],[5,7],[5,8]]}}(),t=function(){return function(e){var t=this;this.regenerate=function(){for(var e=function(){var e=Math.floor(10*Math.random()),n=Math.floor(10*Math.random());if(0===t.snake.getBody().filter(function(t){return t[0]===e&&t[1]===n}).length)return t.position=[e,n],{value:void 0}};;){var n=e();if("object"==typeof n)return n.value}},this.snake=e,this.regenerate()}}(),n=function(){return function(e,t){var n=this;this.createPlayground=function(e){var t=10*Math.floor((.8*Math.min(e.getBoundingClientRect().width,e.getBoundingClientRect().height)-16)/10)+16,n=document.createElement("div");return n.className="pg",n.style.width=t+"px",n.style.height=t+"px",n.style.left=Math.floor((e.getBoundingClientRect().width-t)/2)+"px",e.appendChild(n),n},this.createScoreBox=function(e){var t=document.createElement("div");return t.className="sBox",e.appendChild(t),t},this.clearPlayground=function(){n.playground.innerHTML=""},this.setRectDimensions=function(e,t){var o=Math.floor(.1*(n.playground.getBoundingClientRect().width-16));e.style.left=o*t[0]+"px",e.style.top=o*t[1]+"px",e.style.width=o+"px",e.style.height=o+"px"},this.drawFood=function(){var e=document.createElement("div");e.className="food",n.setRectDimensions(e,n.game.food.position),n.playground.appendChild(e)},this.drawSnake=function(){n.game.snake.getBody().forEach(function(e){var t=document.createElement("div");t.className="snkPart",n.setRectDimensions(t,e),n.playground.appendChild(t)})},this.updateScore=function(){n.scoreBox.innerHTML="SCORE: "+n.game.getScore()+" ("+(n.game.getHighScore()||0)+")"},this.draw=function(){n.clearPlayground(),n.drawFood(),n.drawSnake(),n.updateScore()},this.game=e,this.playground=this.createPlayground(t),this.scoreBox=this.createScoreBox(t)}}(),o=function(){return function(o){var i=this;this.testGameOver=function(){if(i.snake.getBody()[0][0]<0||i.snake.getBody()[0][0]>9||i.snake.getBody()[0][1]<0||i.snake.getBody()[0][1]>9)return!0;for(var e=1;e<i.snake.getBody().length;e++)if(i.snake.getBody()[e][0]===i.snake.getBody()[0][0]&&i.snake.getBody()[e][1]===i.snake.getBody()[0][1])return!0;return!1},this.eat=function(){i.food.position[0]===i.snake.getBody()[0][0]&&i.food.position[1]===i.snake.getBody()[0][1]&&(i.snake.grow(),i.food.regenerate())},this.saveHighScore=function(){new GStorage("QRSnk").set("HS",Math.max(i.getScore(),i.highScore).toString())},this.loadHighScore=function(){new GStorage("QRSnk").get("HS",0).then(function(e){return i.highScore=parseInt(e)})},this.getHighScore=function(){return i.highScore},this.getScore=function(){return i.snake.getLength()-i.snake.initialLength},this.tick=function(){return i.snake.move(),i.eat(),i.testGameOver()?(i.saveHighScore(),!0):(i.gameView.draw(),!1)},this.snake=new e,this.food=new t(this.snake),this.gameView=new n(this,o),this.loadHighScore()}}(),i=function(){var e=document.getElementById("game-content");e.innerHTML="";var t=new o(e);!function(e,t){["LEFT","RIGHT"].forEach(function(n){var o=document.createElement("div");o.className="dirBtn "+n.toLowerCase(),o.onclick=function(){return e.snake.turn(n)},t.appendChild(o)})}(t,e),r(t)},r=function(e){var t;e.tick()?((t=document.createElement("div")).innerHTML="GAME OVER",t.className="go",t.onclick=function(e){i()},document.getElementById("game-content").appendChild(t)):setTimeout(function(){return r(e)},500)};window.onload=i;</script><div id=game-content></div>
  `;

  return (
    <>
      <iframe title="gameField" srcDoc={buildCode(code)} style={frameStyle}></iframe>
    </>
  );
}
